Stocks = [
%Price, Avg Vol, Market Cap, EPS, P/E, P/B, P/S, EBITDA, 50MA, 200MA, Dow
8.2 17184400 8.769 0.229 35.81 0.66 0.37 2.173 8.4766 8.609 1; %AA
74.76 5438870 82.134 3.963 18.86 4.26 2.76 0 71.053 63.6667 1; %AXP
98.49 5036270 74.722 5.327 18.49 10.01 0.92 7.795 94.8483 82.4419 1; %A
13.09 142456992 141.1 0.32 40.91 0.65 1.81 0 12.838 11.8409 1; %AC
84.42 7016660 55.505 7.418 11.38 3.04 0.88 10.423 85.9403 89.2179 1; %CAT
24.32 34975600 130.0 1.8 13.51 2.28 2.71 13.230 21.19 19.9894 1; %CSCO
121.57 6380040 235.7 13.232 9.19 1.68 1.08 46.203 122.136 115.841 1; %CVX
54.61 6564690 50.267 4.925 11.09 4.18 1.43 6.087 54.2266 48.7076 1; %DD
63.12 8166400 113.7 3.301 19.12 2.7 2.6 11.353 64.3836 56.3445 1; %DIS
23.32 39360200 241.1 1.35 17.27 1.95 1.66 28.142 22.8803 22.4181 1; %GE
75.1 6920520 109.7 3.15 23.84 6.69 1.44 9.990 75.9423 68.9508 1; %HD
24.19 22521300 46.808 -6.852 0 1.99 0.41 13.916 21.6639 18.6148 1; %HPQ
202.74 4307820 224.8 14.501 13.98 11.77 2.18 26.399 202.903 201.315 1; %IM
24.7 44316000 122.8 2.001 12.34 2.39 2.32 21.148 21.6489 21.166 1; %INTC
83.68 9888540 235.0 3.682 22.73 3.51 3.43 21.741 85.7177 77.6352 1; %JNJ
53.03 24147700 200.9 5.602 9.47 1.02 2.19 0 50.5331 47.4737 1; %JPM
40.65 14200200 181.0 1.911 21.27 5.57 3.78 13.148 42.1281 39.2342 1; %KO
96.42 5115680 96.666 5.392 17.88 6.35 3.5 9.839 100.623 95.5478 1; %MCD
108.59 2807340 74.948 6.34 17.13 4.14 2.49 7.806 108.605 101.84 1; %MMM
48.73 18354600 147.1 1.96 24.86 2.77 3.18 16.365 46.8503 44.2846 1; %MRK
34.78 49855600 290.5 1.938 17.95 3.79 3.82 30.493 28.6342 27.9396 1; %MSFT
27.48 37193800 194.9 2.089 13.15 2.37 3.38 25.335 29.2297 27.5473 1; %PFE
76.66 9449100 210.1 4.463 17.18 3.18 2.51 19.700 78.7754 74.907 1; %PG
35.26 25275200 189.7 1.293 27.27 2.17 1.49 28.818 37.0725 35.7074 1; %T
82.24 1947490 30.957 6.586 12.49 1.21 1.21 4.513 85.1308 79.7416 1; %TRV
61.75 5992070 62.985 5.132 12.03 1.97 0.55 10.013 61.385 57.0026 1; %UNH
93.01 3297860 85.504 6.678 13.93 3.26 1.43 10.052 94.1489 89.1739 1; %UTX
48.3 12995800 138.2 0.399 121.05 4.15 1.18 31.521 51.7822 47.0965 1; %VZ
75.25 7418580 248.4 5.075 14.83 3.54 0.53 36.459 77.7626 73.0421 1; %WMT
89.65 13151000 398.6 9.83 9.12 2.39 0.96 71.864 90.1617 89.2324 1; %XOM
445.11 17939600 417.8 41.896 10.62 3.09 2.47 57.381 431.59 505.657 0; %AAPL
3.91 27123400 2.794 -0.995 0 6.73 0.57 -0.170 3.5017 3.1414 0; %AMD
267.17 3442660 121.6 -0.192 0 14.42 1.9 2.710 264.631 255.814 0; %AMZN
14.3 8606650 15.981 1.075 13.3 1.38 3.19 1.670 14.5366 12.421 0; %ATVI
353.03 497142 10.912 9.228 38.26 8.48 3.87 0.5658 365.011 350.198 0; %CMG
109.17 2032310 47.651 4.623 23.61 4.55 0.45 3.991 104.607 100.956 0; %COST
17.56 13706500 14.891 1.048 16.76 0 0.41 4.062 17.5749 16.8805 0; %DAL
13.43 32552600 23.476 1.058 12.69 2.19 0.41 3.711 14.138 11.9231 0; %DELL
22.899 45116100 55.368 0.046 497.8 4.67 10.09 1.310 26.6331 26.1612 0; %F
859.7 2320560 285.2 33.422 25.72 3.77 5.33 16.813 805.294 744.272 0; %GOOG
36.79 578934 66.307 2.589 14.21 1.04 0.53 14.426 39.9136 37.7497 0; %HMC
163.49 2308510 18.043 0.258 633.68 18.17 16.28 0.1495 178.874 177.656 0; %LNKD
13.63 7446560 9.845 0.512 26.62 1.41 0.57 1.707 13.8926 11.9943 0; %LUV
14.16 10678000 8.183 0.931 15.21 1.7 1.9 0.8897 12.6326 12.4229 0; %NVDA
65.5 1853210 21.262 5.702 11.49 2.56 0.87 3.340 63.1408 58.3466 0; %RTN
7.2 56305100 21.730 -1.366 0 3.35 0.61 5.315 7.2217 6.8368 0; %S
43.69 5713620 15.665 6.303 6.93 4.74 1.02 3.590 35.1666 31.7673 0; %STX
70.17 4461850 45.028 4.256 16.49 2.72 0.62 7.643 69.9091 65.2115 0; %TGT
114.87 671938 181.9 7.72 14.88 1.18 0.65 30.827 118.688 102.946 0; %TM
177.22 3081590 115.2 3.564 49.73 4.29 10.38 7.042 175.275 161.616 0; %V
62.81 2978300 14.847 7.931 7.92 1.77 0.91 3.836 49.9369 43.0585 0; %WDC
28.2 1416650 1.817 -0.227 0 10.96 11.63 -0.0045 28.716 23.4061 0; %YELP
25.75 19962600 27.878 3.446 7.47 1.98 5.68 1.327 23.268 20.0919 0; %YHOO
];

Stat = {'Price' 'Avg Vol' 'Market Cap' 'EPS' 'P/E' 'P/B' 'P/S' 'EBITDA' '50MA' '200MA' 'Dow'}

Name = {
    'AA'
'AXP'
'BA'
'BAC'
'CAT'
'CSCO'
'CVX'
'DD'
'DIS'
'GE'
'HD'
'HPQ'
'IBM'
'INTC'
'JNJ'
'JPM'
'KO'
'MCD'
'MMM'
'MRK'
'MSFT'
'PFE'
'PG'
'T'
'TRV'
'UNH'
'UTX'
'VZ'
'WMT'
'XOM'
'AAPL'
'AMD'
'AMZN'
'ATVI'
'CMG'
'COST'
'DAL'
'DELL'
'FB'
'GOOG'
'HMC'
'LNKD'
'LUV'
'NVDA'
'RTN'
'S'
'STX'
'TGT'
'TM'
'V'
'WDC'
'YELP'
'YHOO'
};

n = size(Stocks,1);
p = size(Stocks,2);
StockStats = Stocks(:, 1:(p-1));
Downess = Stocks(:,p);

A = StockStats; %Ax=b
b = Downess;
numStocks = sum(Stocks(:,p))

% Covariance/Correlation Matrix analysis
CovarianceMatrix = cov(StockStats);
CorrelationMatrix = corr(StockStats);

[U,S,V] = svd(CovarianceMatrix);

Cov2PC = U(:,1:2);
XYcoordinates = StockStats * Cov2PC;
X = XYcoordinates(:,1);
Y = XYcoordinates(:,2);

figure
plot( X, Y, 'b.' )
hold on
plot( X(1:numStocks), Y(1:numStocks), 'r.' )
rotate3d on
title('Covariance PCA of Stocks (Dow stocks are red, non-Dow stocks are blue)')
xlabel('1st Principal Component')
ylabel('2nd Principal Component')

for i=1:n
   text( X(i) * 0.99, Y(i) * 1.01, Name(i) )
end
hold off

Cov2PC
